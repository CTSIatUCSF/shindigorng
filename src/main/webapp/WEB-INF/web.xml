<?xml version="1.0" encoding="UTF-8"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
-->
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         version="2.5">
  <display-name>Shindig ORNG</display-name>
  
  <context-param>
    <param-name>guice-modules</param-name>
    <param-value>
			edu.ucsf.orng.shindig.config.OrngPropertiesModule:
			org.apache.shindig.gadgets.DefaultGuiceModule:
			edu.ucsf.orng.shindig.config.OrngSocialApiGuiceModule:
			org.apache.shindig.gadgets.oauth.OAuthModule:
			org.apache.shindig.gadgets.oauth2.OAuth2Module:
			org.apache.shindig.gadgets.oauth2.OAuth2MessageModule:
			edu.ucsf.orng.shindig.auth.OrngOAuth2HandlerModule:
			org.apache.shindig.gadgets.oauth2.persistence.sample.OAuth2PersistenceModule:
			org.apache.shindig.common.cache.ehcache.EhCacheModule:
			org.apache.shindig.extras.ShindigExtrasGuiceModule:
			org.apache.shindig.gadgets.admin.GadgetAdminModule
		</param-value>
  </context-param>
  <context-param>
    <param-name>system.properties</param-name>
    <param-value>
     
        shindig.host=
        shindig.port=
        aKey=/shindig/gadgets/proxy?container=default&amp;url=
     
     </param-value>
  </context-param>
  
  <!--  Unfuddle 259 Coffee Mug Bug -->
  <filter>
    <filter-name>whitelistFilter</filter-name>
    <filter-class>edu.ucsf.orng.shindig.auth.WhitelistGadgetHostSuffixFilter</filter-class>
    <init-param> 
		  <param-name>AllowedGadgetHostSuffixes</param-name>
		  <param-value>researcherprofiles.org,sc-ctsi.org,x-proto.info</param-value>
	</init-param>
  </filter>
  <filter-mapping>
    <filter-name>whitelistFilter</filter-name>
    <url-pattern>/gadgets/ifr</url-pattern>
  </filter-mapping>

  <filter>
    <filter-name>hostFilter</filter-name>
    <filter-class>org.apache.shindig.common.servlet.HostFilter</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>hostFilter</filter-name>
    <url-pattern>/gadgets/ifr</url-pattern>
    <url-pattern>/gadgets/js/*</url-pattern>
    <url-pattern>/gadgets/proxy/*</url-pattern>
    <url-pattern>/gadgets/concat</url-pattern>
    <url-pattern>/gadgets/makeRequest</url-pattern>
    <url-pattern>/rpc/*</url-pattern>
    <url-pattern>/rest/*</url-pattern>
  </filter-mapping>
  <filter>
    <filter-name>authFilter</filter-name>
    <filter-class>org.apache.shindig.auth.AuthenticationServletFilter</filter-class>
  </filter>
  <filter>
    <filter-name>etagFilter</filter-name>
    <filter-class>org.apache.shindig.gadgets.servlet.ETagFilter</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>authFilter</filter-name>
    <url-pattern>/social/*</url-pattern>
    <url-pattern>/gadgets/ifr</url-pattern>
    <url-pattern>/gadgets/makeRequest</url-pattern>
    <url-pattern>/gadgets/proxy</url-pattern>
    <url-pattern>/gadgets/api/rpc/*</url-pattern>
    <url-pattern>/gadgets/api/rest/*</url-pattern>
    <url-pattern>/rpc/*</url-pattern>
    <url-pattern>/rest/*</url-pattern>
  </filter-mapping>
  <filter-mapping>
    <filter-name>etagFilter</filter-name>
    <url-pattern>*</url-pattern>
  </filter-mapping>
  <listener>
    <listener-class>org.apache.shindig.common.servlet.GuiceServletContextListener</listener-class>
  </listener>
  <servlet>
    <servlet-name>xml-to-html</servlet-name>
    <servlet-class>
      org.apache.shindig.gadgets.servlet.GadgetRenderingServlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>accel</servlet-name>
    <servlet-class>
      org.apache.shindig.gadgets.servlet.HtmlAccelServlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>proxy</servlet-name>
    <servlet-class>
      org.apache.shindig.gadgets.servlet.ProxyServlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>makeRequest</servlet-name>
    <servlet-class>
      org.apache.shindig.gadgets.servlet.MakeRequestServlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>concat</servlet-name>
    <servlet-class>
      org.apache.shindig.gadgets.servlet.ConcatProxyServlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>oauthCallback</servlet-name>
    <servlet-class>
      org.apache.shindig.gadgets.servlet.OAuthCallbackServlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>oauth2callback</servlet-name>
    <servlet-class>
      org.apache.shindig.gadgets.servlet.OAuth2CallbackServlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>metadata</servlet-name>
    <servlet-class>
      org.apache.shindig.gadgets.servlet.RpcServlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>js</servlet-name>
    <servlet-class>org.apache.shindig.gadgets.servlet.JsServlet</servlet-class>
  </servlet>
  <servlet>
    <servlet-name>restapiServlet</servlet-name>
    <servlet-class>
      org.apache.shindig.protocol.DataServiceServlet
    </servlet-class>
    <init-param>
      <param-name>handlers</param-name>
      <param-value>org.apache.shindig.handlers</param-value>
    </init-param>
  </servlet>
  <servlet>
    <servlet-name>jsonRpcServlet</servlet-name>
    <servlet-class>
      org.apache.shindig.protocol.JsonRpcServlet
    </servlet-class>
    <init-param>
      <param-name>handlers</param-name>
      <param-value>org.apache.shindig.handlers</param-value>
    </init-param>
  </servlet>
  <servlet>
    <servlet-name>sampleOAuth</servlet-name>
    <servlet-class>
      org.apache.shindig.social.sample.oauth.SampleOAuthServlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>OAuth2Servlet</servlet-name>
    <servlet-class>
      org.apache.shindig.social.core.oauth2.OAuth2Servlet
    </servlet-class>
  </servlet>
  <servlet>
    <servlet-name>rpcSwf</servlet-name>
    <servlet-class>
      org.apache.shindig.gadgets.servlet.RpcSwfServlet
    </servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>js</servlet-name>
    <url-pattern>/gadgets/js/*</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>proxy</servlet-name>
    <url-pattern>/gadgets/proxy/*</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>makeRequest</servlet-name>
    <url-pattern>/gadgets/makeRequest</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>jsonRpcServlet</servlet-name>
    <url-pattern>/rpc/*</url-pattern>
    <url-pattern>/gadgets/api/rpc/*</url-pattern>
    <url-pattern>/social/rpc/*</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>restapiServlet</servlet-name>
    <url-pattern>/rest/*</url-pattern>
    <url-pattern>/gadgets/api/rest/*</url-pattern>
    <url-pattern>/social/rest/*</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>concat</servlet-name>
    <url-pattern>/gadgets/concat</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>oauthCallback</servlet-name>
    <url-pattern>/gadgets/oauthcallback</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>oauth2callback</servlet-name>
    <url-pattern>/gadgets/oauth2callback</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>xml-to-html</servlet-name>
    <url-pattern>/gadgets/ifr</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>accel</servlet-name>
    <url-pattern>/gadgets/accel</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>metadata</servlet-name>
    <url-pattern>/gadgets/metadata</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>sampleOAuth</servlet-name>
    <url-pattern>/oauth/*</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>OAuth2Servlet</servlet-name>
    <url-pattern>/oauth2/*</url-pattern>
  </servlet-mapping>
  <servlet-mapping>
    <servlet-name>rpcSwf</servlet-name>
    <url-pattern>/xpc*</url-pattern>
  </servlet-mapping>
  <filter>
    <display-name>WhitelistGadgetHostSuffixFilter</display-name>
    <filter-name>WhitelistGadgetHostSuffixFilter</filter-name>
    <filter-class>edu.ucsf.orng.shindig.auth.WhitelistGadgetHostSuffixFilter</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>WhitelistGadgetHostSuffixFilter</filter-name>
    <url-pattern>/WhitelistGadgetHostSuffixFilter</url-pattern>
  </filter-mapping>
</web-app>